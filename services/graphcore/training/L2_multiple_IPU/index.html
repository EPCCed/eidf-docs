
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.eidf.ac.uk/services/graphcore/training/L2_multiple_IPU/">
      
      
        <link rel="prev" href="../L1_getting_started/">
      
      
        <link rel="next" href="../L3_profiling/">
      
      
      <link rel="icon" href="../../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Multi-IPU Jobs - EIDF User Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/eidf.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/access.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#distributed-training-on-multiple-ipus" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            

          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="EIDF User Documentation" class="md-header__button md-logo" aria-label="EIDF User Documentation" data-md-component="logo">
      
  <img src="../../../../images/EIDF_rgb.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EIDF User Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multi-IPU Jobs
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/EPCCed/eidf-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EPCCed/eidf-docs.git
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="EIDF User Documentation" class="md-nav__button md-logo" aria-label="EIDF User Documentation" data-md-component="logo">
      
  <img src="../../../../images/EIDF_rgb.png" alt="logo">

    </a>
    EIDF User Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EPCCed/eidf-docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    EPCCed/eidf-docs.git
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Status
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About EIDF
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            About EIDF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/contacts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Service Access
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Service Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web and SSH
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../access/project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EIDF Web Portal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../access/virtualmachines-vdi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtual Desktop Interface
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Storage in the EIDF
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Storage in the EIDF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computing Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Computing Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Virtual Desktops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Virtual Desktops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    QuickStart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Managing VMs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../access/virtualmachines-vdi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtual Desktop Interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/sharedfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shared Filesystem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../access/ssh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSH Access to VMs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/flavours/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VM Flavours
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Policies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualmachines/rdp-tunnelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RDP tunnelling over SSH
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ultra2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Ultra2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ultra2/access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ultra2/connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ultra2/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running codes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cerebras
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Cerebras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cerebras/access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cerebras/connect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cerebras/run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running codes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GPU Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            GPU Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Policies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/kueue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kueue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/shared-cephfs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shared Filesystem (CephFS) PVCs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_5" >
        
          
          <label class="md-nav__link" for="__nav_6_4_5" id="__nav_6_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_5">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/training/L1_getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/training/L2_requesting_persistent_volumes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Persistent Volumes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/training/L3_running_a_pytorch_task/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running a Pytorch Pod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/training/L4_template_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Template K8s Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gpuservice/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPU Service FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" checked>
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Graphcore Bow Pod64
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Graphcore Bow Pod64
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_6_5_2" id="__nav_6_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_5_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../L1_getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Multi-IPU Jobs
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Multi-IPU Jobs
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-example" class="md-nav__link">
    <span class="md-ellipsis">
      First example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    <span class="md-ellipsis">
      Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Memory usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scaling-up-ipu-count-and-using-poprun" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling up IPU count and using Poprun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-on-using-the-examples-respository" class="md-nav__link">
    <span class="md-ellipsis">
      Notes on using the examples respository
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../L3_profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../L4_other_frameworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Frameworks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graphcore FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../jhub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../jhub/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Data Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    S3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            S3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../s3/manage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Manage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../s3/tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Publishing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Data Publishing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../datapublishing/service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../datapublishing/catalogue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Your Data Catalogue entry
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Catalogue
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Data Catalogue
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../datacatalogue/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata information
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Code Collaboration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Code Collaboration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gitlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitlab Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gitlab/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitlab Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Safe Haven Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Safe Haven Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/network-access-controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Access Controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/safe-haven-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Safe Haven Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/virtual-desktop-connections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtual Desktop Connections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/using-the-hpc-cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using the HPC Cluster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6" >
        
          
          <label class="md-nav__link" for="__nav_8_6" id="__nav_8_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Superdome Flex Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6">
            <span class="md-nav__icon md-icon"></span>
            Superdome Flex Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/superdome-flex-tutorial/L1_Accessing_the_SDF_Inside_the_EPCC_TRE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accessing the SDF Inside the EPCC TRE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/superdome-flex-tutorial/L2_running_R_Python_analysis_scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running R/Python Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/superdome-flex-tutorial/L3_submitting_scripts_to_slurm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Submitting Scripts to Slurm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/superdome-flex-tutorial/L4_parallelised_python_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelised Python Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/superdome-flex-tutorial/L5_parallelised_r_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parallelised R Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7" >
        
          
          <label class="md-nav__link" for="__nav_8_7" id="__nav_8_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    TRE Container User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7">
            <span class="md-nav__icon md-icon"></span>
            TRE Container User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/tre-container-user-guide/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/tre-container-user-guide/development-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/tre-container-user-guide/workflow-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../safe-haven-services/tre-container-user-guide/container-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Container Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../known-issues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EIDF Known Issues
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EIDF Frequently Asked Questions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial-videos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EIDF Tutorial Videos
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-example" class="md-nav__link">
    <span class="md-ellipsis">
      First example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    <span class="md-ellipsis">
      Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Memory usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scaling-up-ipu-count-and-using-poprun" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling up IPU count and using Poprun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes-on-using-the-examples-respository" class="md-nav__link">
    <span class="md-ellipsis">
      Notes on using the examples respository
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="distributed-training-on-multiple-ipus">Distributed training on multiple IPUs</h1>
<p>In this tutorial, we will cover how to run larger models, including examples provided by Graphcore on <a href="https://github.com/graphcore/examples">https://github.com/graphcore/examples</a>. These may require distributed training on multiple IPUs.</p>
<p>The number of IPUs requested must be in powers of two, i.e. 1, 2, 4, 8, 16, 32, or 64.</p>
<h2 id="first-example">First example</h2>
<p>As an example, we will use 4 IPUs to perform the pre-training step of BERT, an NLP transformer model. The code is available from <a href="https://github.com/graphcore/examples/tree/master/nlp/bert/pytorch">https://github.com/graphcore/examples/tree/master/nlp/bert/pytorch</a>.</p>
<p>To get started, save and create an IPUJob with the following <code>.yaml</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">graphcore.ai/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPUJob</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bert-training-multi-ipu-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jobInstances</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">ipusPerJobInstance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="w">  </span><span class="nt">workers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">        </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bert-training-multi-ipu</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">graphcore/pytorch:3.3.0</span>
<span class="w">          </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/bin/bash</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-c</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">cd ;</span>
<span class="w">              </span><span class="no">mkdir build;</span>
<span class="w">              </span><span class="no">cd build ;</span>
<span class="w">              </span><span class="no">git clone https://github.com/graphcore/examples.git;</span>
<span class="w">              </span><span class="no">cd examples/nlp/bert/pytorch;</span>
<span class="w">              </span><span class="no">apt update ;</span>
<span class="w">              </span><span class="no">apt upgrade -y;</span>
<span class="w">              </span><span class="no">DEBIAN_FRONTEND=noninteractive TZ=&#39;Europe/London&#39; apt install $(&lt; required_apt_packages.txt) -y ;</span>
<span class="w">              </span><span class="no">pip3 install -r requirements.txt ;</span>
<span class="w">              </span><span class="no">python3 run_pretraining.py --dataset generated --config pretrain_base_128_pod4 --training-steps 1</span>
<span class="w">          </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">            </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">              </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">              </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200Gi</span>
<span class="w">          </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">            </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">              </span><span class="nt">add</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPC_LOCK</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/shm</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
<span class="w">        </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
<span class="w">        </span><span class="nt">hostIPC</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">emptyDir</span><span class="p">:</span>
<span class="w">            </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Memory</span>
<span class="w">            </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10Gi</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
</code></pre></div>
<p>Running the above IPUJob and querying the log via <code>kubectl logs pod/bert-training-multi-ipu-&lt;random string&gt;-worker-0</code> should give:</p>
<div class="highlight"><pre><span></span><code>...
Data<span class="w"> </span>loaded<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">8</span>.559805537108332<span class="w"> </span>secs
-----------------------------------------------------------
--------------------<span class="w"> </span>Device<span class="w"> </span>Allocation<span class="w"> </span>--------------------
Embedding<span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">0</span>
Encoder<span class="w"> </span><span class="m">0</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">1</span>
Encoder<span class="w"> </span><span class="m">1</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">1</span>
Encoder<span class="w"> </span><span class="m">2</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">1</span>
Encoder<span class="w"> </span><span class="m">3</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">1</span>
Encoder<span class="w"> </span><span class="m">4</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">2</span>
Encoder<span class="w"> </span><span class="m">5</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">2</span>
Encoder<span class="w"> </span><span class="m">6</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">2</span>
Encoder<span class="w"> </span><span class="m">7</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">2</span>
Encoder<span class="w"> </span><span class="m">8</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">3</span>
Encoder<span class="w"> </span><span class="m">9</span><span class="w">  </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">3</span>
Encoder<span class="w"> </span><span class="m">10</span><span class="w"> </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">3</span>
Encoder<span class="w"> </span><span class="m">11</span><span class="w"> </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">3</span>
Pooler<span class="w">     </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">0</span>
Classifier<span class="w"> </span>--&gt;<span class="w"> </span>IPU<span class="w"> </span><span class="m">0</span>
-----------------------------------------------------------
----------<span class="w"> </span>Compilation/Loading<span class="w"> </span>from<span class="w"> </span>Cache<span class="w"> </span>Started<span class="w"> </span>---------

...

Graph<span class="w"> </span>compilation:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span><span class="p">|</span><span class="w"> </span><span class="m">100</span>/100<span class="w"> </span><span class="o">[</span><span class="m">08</span>:02&lt;<span class="m">00</span>:00<span class="o">]</span>
Compiled/Loaded<span class="w"> </span>model<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">500</span>.756152929971<span class="w"> </span>secs
-----------------------------------------------------------
---------------------<span class="w"> </span>Training<span class="w"> </span>Started<span class="w"> </span>--------------------
Step:<span class="w"> </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>LR:<span class="w"> </span><span class="m">0</span>.00e+00<span class="w"> </span>-<span class="w"> </span>total<span class="w"> </span>loss:<span class="w"> </span><span class="m">10</span>.817<span class="w"> </span>-<span class="w"> </span>mlm_loss:<span class="w"> </span><span class="m">10</span>.386<span class="w"> </span>-<span class="w"> </span>nsp_loss:<span class="w"> </span><span class="m">0</span>.432<span class="w"> </span>-<span class="w"> </span>mlm_acc:<span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>%<span class="w"> </span>-<span class="w"> </span>nsp_acc:<span class="w"> </span><span class="m">1</span>.000<span class="w"> </span>%:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:16&lt;?,<span class="w"> </span>?it/s,<span class="w"> </span>throughput:<span class="w"> </span><span class="m">4035</span>.0<span class="w"> </span>samples/sec<span class="o">]</span>
-----------------------------------------------------------
--------------------<span class="w"> </span>Training<span class="w"> </span>Metrics<span class="w"> </span>---------------------
global_batch_size:<span class="w"> </span><span class="m">65536</span>
device_iterations:<span class="w"> </span><span class="m">1</span>
training_steps:<span class="w"> </span><span class="m">1</span>
Training<span class="w"> </span>time:<span class="w"> </span><span class="m">16</span>.245<span class="w"> </span>secs
-----------------------------------------------------------
</code></pre></div>
<h2 id="details">Details</h2>
<p>In this example, we have requested 4 IPUs:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ipusPerJobInstance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
</code></pre></div>
<p>The python flag <code>--config pretrain_base_128_pod4</code> uses one of the preset configurations for this model with 4 IPUs. Here we also use the <code>--datset generated</code> flag to generate data rather than download the required dataset.</p>
<p>To provided sufficient shm for the IPU pod, it may be necessary to mount <code>/dev/shm</code> as follows:</p>
<div class="highlight"><pre><span></span><code><span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/shm</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
<span class="w">       </span><span class="w w-Error"> </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">emptyDir</span><span class="p">:</span>
<span class="w">            </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Memory</span>
<span class="w">            </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10Gi</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
</code></pre></div>
<p>It is also required to set <code>spec.hostIPC</code> to <code>true</code>:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">hostIPC</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p>and add a <code>securityContext</code> to the container definition than enables the <code>IPC_LOCK</code> capability:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">      </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">        </span><span class="nt">add</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPC_LOCK</span>
</code></pre></div>
<p>Note: <code>IPC_LOCK</code> allows for the RDMA software stack to use pinned memory  which is particularly useful for PyTorch dataloaders, which can be very memory hungry. This is since all data going to the IPUs go via the network interfaces (via 100Gbps ethernet).</p>
<h3 id="memory-usage">Memory usage</h3>
<p>In general, the graph compilation phase of running large models can require significant memory, and far less during the execution phase.</p>
<p>In the example above, it is possible to explicitly request the memory via:</p>
<div class="highlight"><pre><span></span><code><span class="w">          </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">            </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">              </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;128Gi&quot;</span>
<span class="w">            </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">              </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;128Gi&quot;</span>
</code></pre></div>
<p>which will succeed. (The graph compilation fails if only <code>32Gi</code> is requested.)</p>
<p>As a general guideline, 128GB memory should be enough for the majority of tasks, and rarely exceed 200GB even for jobs with high IPU count. In the example <code>.yaml</code> script, we do not specifically request the memory.</p>
<h2 id="scaling-up-ipu-count-and-using-poprun">Scaling up IPU count and using Poprun</h2>
<p>In the example above, python is launched directly in the pod. When scaling up the number of IPUs (e.g. above 8 IPUs), it may be possible to run into a CPU bottleneck. This may be observed when the throughput scales sub-linearly with the number of data-parallel replicas (i.e. when doubling the IPU count, the performance does not double). This can also be verified by profiling the application and observing a significant proportion of runtime spent on host CPU workload.</p>
<p>In this case, <a href="https://docs.graphcore.ai/projects/poprun-user-guide/en/latest/launching.html">Poprun</a> can be used launch multiple instances. As an example, we will save the following .yaml configuratoin and run:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">graphcore.ai/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPUJob</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">generateName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bert-poprun-64ipus-</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jobInstances</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">modelReplicasPerWorker</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16&quot;</span>
<span class="w">  </span><span class="nt">ipusPerJobInstance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;64&quot;</span>
<span class="w">  </span><span class="nt">workers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">        </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bert-poprun-64ipus</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">graphcore/pytorch:3.3.0</span>
<span class="w">          </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">/bin/bash</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-c</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">              </span><span class="no">cd ;</span>
<span class="w">              </span><span class="no">mkdir build;</span>
<span class="w">              </span><span class="no">cd build ;</span>
<span class="w">              </span><span class="no">git clone https://github.com/graphcore/examples.git;</span>
<span class="w">              </span><span class="no">cd examples/nlp/bert/pytorch;</span>
<span class="w">              </span><span class="no">apt update ;</span>
<span class="w">              </span><span class="no">apt upgrade -y;</span>
<span class="w">              </span><span class="no">DEBIAN_FRONTEND=noninteractive TZ=&#39;Europe/London&#39; apt install $(&lt; required_apt_packages.txt) -y ;</span>
<span class="w">              </span><span class="no">pip3 install -r requirements.txt ;</span>
<span class="w">              </span><span class="no">OMPI_ALLOW_RUN_AS_ROOT_CONFIRM=1 OMPI_ALLOW_RUN_AS_ROOT=1 \</span>
<span class="w">              </span><span class="no">poprun \</span>
<span class="w">              </span><span class="no">--allow-run-as-root 1 \</span>
<span class="w">              </span><span class="no">--vv \</span>
<span class="w">              </span><span class="no">--num-instances 1 \</span>
<span class="w">              </span><span class="no">--num-replicas 16 \</span>
<span class="w">               </span><span class="no">--mpi-global-args=&quot;--tag-output&quot; \</span>
<span class="w">              </span><span class="no">--ipus-per-replica 4 \</span>
<span class="w">              </span><span class="no">python3 run_pretraining.py \</span>
<span class="w">              </span><span class="no">--config pretrain_large_128_POD64 \</span>
<span class="w">              </span><span class="no">--dataset generated --training-steps 1</span>
<span class="w">          </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">            </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">              </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">              </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200Gi</span>
<span class="w">          </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">            </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">              </span><span class="nt">add</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IPC_LOCK</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/shm</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
<span class="w">        </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
<span class="w">        </span><span class="nt">hostIPC</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">emptyDir</span><span class="p">:</span>
<span class="w">            </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Memory</span>
<span class="w">            </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10Gi</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">devshm</span>
</code></pre></div>
<p>Inspecting the log via <code>kubectl logs &lt;pod-name&gt;</code> should produce:</p>
<div class="highlight"><pre><span></span><code>...
<span class="w"> </span><span class="o">===========================================================================================</span>
<span class="p">|</span><span class="w">                                      </span>poprun<span class="w"> </span>topology<span class="w">                                      </span><span class="p">|</span>
<span class="p">|</span><span class="o">===========================================================================================</span><span class="p">|</span>
<span class="m">10</span>:10:50.154<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>Done<span class="w"> </span>polling,<span class="w"> </span>final<span class="w"> </span>state<span class="w"> </span>of<span class="w"> </span>p-bert-poprun-64ipus-gc-dev-0:<span class="w"> </span>PS_ACTIVE
<span class="m">10</span>:10:50.154<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>Target<span class="w"> </span>options<span class="w"> </span>from<span class="w"> </span>environment:<span class="w"> </span><span class="o">{}</span>
<span class="p">|</span><span class="w"> </span>hosts<span class="w">     </span><span class="p">|</span><span class="w">                                   </span>localhost<span class="w">                                   </span><span class="p">|</span>
<span class="p">|</span>-----------<span class="p">|</span>-------------------------------------------------------------------------------<span class="p">|</span>
<span class="p">|</span><span class="w"> </span>ILDs<span class="w">      </span><span class="p">|</span><span class="w">                                       </span><span class="m">0</span><span class="w">                                       </span><span class="p">|</span>
<span class="p">|</span>-----------<span class="p">|</span>-------------------------------------------------------------------------------<span class="p">|</span>
<span class="p">|</span><span class="w"> </span>instances<span class="w"> </span><span class="p">|</span><span class="w">                                       </span><span class="m">0</span><span class="w">                                       </span><span class="p">|</span>
<span class="p">|</span>-----------<span class="p">|</span>-------------------------------------------------------------------------------<span class="p">|</span>
<span class="p">|</span><span class="w"> </span>replicas<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">6</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">7</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">8</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">9</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="p">|</span>
<span class="w"> </span>-------------------------------------------------------------------------------------------
<span class="m">10</span>:10:50.154<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>Target<span class="w"> </span>options<span class="w"> </span>from<span class="w"> </span>V-IPU<span class="w"> </span>partition:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;ipuLinkDomainSize&quot;</span>:<span class="s2">&quot;64&quot;</span>,<span class="s2">&quot;ipuLinkConfiguration&quot;</span>:<span class="s2">&quot;slidingWindow&quot;</span>,<span class="s2">&quot;ipuLinkTopology&quot;</span>:<span class="s2">&quot;torus&quot;</span>,<span class="s2">&quot;gatewayMode&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;instanceSize&quot;</span>:<span class="s2">&quot;64&quot;</span><span class="o">}</span>
<span class="m">10</span>:10:50.154<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>target<span class="w"> </span>options:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;ipuLinkDomainSize&quot;</span>:<span class="s2">&quot;64&quot;</span>,<span class="s2">&quot;ipuLinkConfiguration&quot;</span>:<span class="s2">&quot;slidingWindow&quot;</span>,<span class="s2">&quot;ipuLinkTopology&quot;</span>:<span class="s2">&quot;torus&quot;</span>,<span class="s2">&quot;gatewayMode&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;instanceSize&quot;</span>:<span class="s2">&quot;64&quot;</span><span class="o">}</span>
<span class="m">10</span>:10:50.203<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>hosts<span class="w"> </span>specified<span class="p">;</span><span class="w"> </span>ignoring<span class="w"> </span>host-subnet<span class="w"> </span>setting
<span class="m">10</span>:10:50.203<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>D<span class="o">]</span><span class="w"> </span>Default<span class="w"> </span>network/RNIC<span class="w"> </span><span class="k">for</span><span class="w"> </span>host<span class="w"> </span>communication:<span class="w"> </span>None
<span class="m">10</span>:10:50.203<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>I<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span>command:<span class="w"> </span>/opt/poplar/bin/mpirun<span class="w"> </span><span class="s1">&#39;--tag-output&#39;</span><span class="w"> </span><span class="s1">&#39;--bind-to&#39;</span><span class="w"> </span><span class="s1">&#39;none&#39;</span><span class="w"> </span><span class="s1">&#39;--tag-output&#39;</span>
<span class="s1">&#39;--allow-run-as-root&#39;</span><span class="w"> </span><span class="s1">&#39;-np&#39;</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;POPDIST_NUM_TOTAL_REPLICAS=16&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;POPDIST_NUM_IPUS_PER_REPLICA=4&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span>
<span class="s1">&#39;POPDIST_NUM_LOCAL_REPLICAS=16&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;POPDIST_UNIFORM_REPLICAS_PER_INSTANCE=1&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;POPDIST_REPLICA_INDEX_OFFSET=0&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span>
<span class="s1">&#39;POPDIST_LOCAL_INSTANCE_INDEX=0&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;IPUOF_VIPU_API_HOST=10.21.21.129&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;IPUOF_VIPU_API_PORT=8090&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span>
<span class="s1">&#39;IPUOF_VIPU_API_PARTITION_ID=p-bert-poprun-64ipus-gc-dev-0&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;IPUOF_VIPU_API_TIMEOUT=120&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;IPUOF_VIPU_API_GCD_ID=0&#39;</span>
<span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;IPUOF_LOG_LEVEL=WARN&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;PATH&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;LD_LIBRARY_PATH&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;PYTHONPATH&#39;</span><span class="w"> </span><span class="s1">&#39;-x&#39;</span><span class="w"> </span><span class="s1">&#39;POPLAR_TARGET_OPTIONS=</span>
<span class="s1">{&quot;ipuLinkDomainSize&quot;:&quot;64&quot;,&quot;ipuLinkConfiguration&quot;:&quot;slidingWindow&quot;,&quot;ipuLinkTopology&quot;:&quot;torus&quot;,&quot;gatewayMode&quot;:&quot;true&quot;,</span>
<span class="s1">&quot;instanceSize&quot;:&quot;64&quot;}&#39;</span><span class="w"> </span><span class="s1">&#39;python3&#39;</span><span class="w"> </span><span class="s1">&#39;run_pretraining.py&#39;</span><span class="w"> </span><span class="s1">&#39;--config&#39;</span><span class="w"> </span><span class="s1">&#39;pretrain_large_128_POD64&#39;</span><span class="w"> </span><span class="s1">&#39;--dataset&#39;</span><span class="w"> </span><span class="s1">&#39;generated&#39;</span><span class="w"> </span><span class="s1">&#39;--training-steps&#39;</span><span class="w"> </span><span class="s1">&#39;1&#39;</span>
<span class="m">10</span>:10:50.204<span class="w"> </span><span class="m">1</span><span class="w"> </span>POPRUN<span class="w"> </span><span class="o">[</span>I<span class="o">]</span><span class="w"> </span>Waiting<span class="w"> </span><span class="k">for</span><span class="w"> </span>mpirun<span class="w"> </span><span class="o">(</span>PID<span class="w"> </span><span class="m">4346</span><span class="o">)</span>
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:<span class="w">    </span>Registered<span class="w"> </span>metric<span class="w"> </span>hook:<span class="w"> </span>total_compiling_time<span class="w"> </span>with<span class="w"> </span>object:<span class="w"> </span>&lt;<span class="k">function</span><span class="w"> </span>get_results_for_compile_time<span class="w"> </span>at<span class="w"> </span>0x7fe0a6e8af70&gt;
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:Using<span class="w"> </span>config:<span class="w"> </span>pretrain_large_128_POD64
...
Graph<span class="w"> </span>compilation:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span><span class="p">|</span><span class="w"> </span><span class="m">100</span>/100<span class="w"> </span><span class="o">[</span><span class="m">10</span>:11&lt;<span class="m">00</span>:00<span class="o">][</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:Compiled/Loaded<span class="w"> </span>model<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">683</span>.6591004971415<span class="w"> </span>secs
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:-----------------------------------------------------------
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:---------------------<span class="w"> </span>Training<span class="w"> </span>Started<span class="w"> </span>--------------------
Step:<span class="w"> </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>LR:<span class="w"> </span><span class="m">0</span>.00e+00<span class="w"> </span>-<span class="w"> </span>total<span class="w"> </span>loss:<span class="w"> </span><span class="m">11</span>.260<span class="w"> </span>-<span class="w"> </span>mlm_loss:<span class="w"> </span><span class="m">10</span>.397<span class="w"> </span>-<span class="w"> </span>nsp_loss:<span class="w"> </span><span class="m">0</span>.863<span class="w"> </span>-<span class="w"> </span>mlm_acc:<span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>%<span class="w"> </span>-<span class="w"> </span>nsp_acc:<span class="w"> </span><span class="m">0</span>.052<span class="w"> </span>%:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;?,<span class="w"> </span>?itStep:<span class="w"> </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>LR:<span class="w"> </span><span class="m">0</span>.00e+00<span class="w"> </span>-<span class="w"> </span>total<span class="w"> </span>loss:<span class="w"> </span><span class="m">11</span>.260<span class="w"> </span>-<span class="w"> </span>mlm_loss:<span class="w"> </span><span class="m">10</span>.397<span class="w"> </span>-<span class="w"> </span>nsp_loss:<span class="w"> </span><span class="m">0</span>.863<span class="w"> </span>-<span class="w"> </span>mlm_acc:<span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>%<span class="w"> </span>-<span class="w"> </span>nsp_acc:<span class="w"> </span><span class="m">0</span>.052<span class="w"> </span>%:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;?,<span class="w"> </span>?itStep:<span class="w"> </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span><span class="m">0</span><span class="w"> </span>-<span class="w"> </span>LR:<span class="w"> </span><span class="m">0</span>.00e+00<span class="w"> </span>-<span class="w"> </span>total<span class="w"> </span>loss:<span class="w"> </span><span class="m">11</span>.260<span class="w"> </span>-<span class="w"> </span>mlm_loss:<span class="w"> </span><span class="m">10</span>.397<span class="w"> </span>-<span class="w"> </span>nsp_loss:<span class="w"> </span><span class="m">0</span>.863<span class="w"> </span>-<span class="w"> </span>mlm_acc:<span class="w"> </span><span class="m">0</span>.000<span class="w"> </span>%<span class="w"> </span>-<span class="w"> </span>nsp_acc:<span class="w"> </span><span class="m">0</span>.052<span class="w"> </span>%:<span class="w">   </span><span class="m">0</span>%<span class="p">|</span><span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="m">0</span>/1<span class="w"> </span><span class="o">[</span><span class="m">00</span>:03&lt;?,<span class="w"> </span>?it/s,<span class="w"> </span>throughput:<span class="w"> </span><span class="m">17692</span>.1<span class="w"> </span>samples/sec<span class="o">][</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:-----------------------------------------------------------
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:--------------------<span class="w"> </span>Training<span class="w"> </span>Metrics<span class="w"> </span>---------------------
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:global_batch_size:<span class="w"> </span><span class="m">65536</span>
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:device_iterations:<span class="w"> </span><span class="m">1</span>
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:training_steps:<span class="w"> </span><span class="m">1</span>
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:Training<span class="w"> </span>time:<span class="w"> </span><span class="m">3</span>.718<span class="w"> </span>secs
<span class="o">[</span><span class="m">1</span>,0<span class="o">]</span>&lt;stderr&gt;:-----------------------------------------------------------
</code></pre></div>
<h2 id="notes-on-using-the-examples-respository">Notes on using the examples respository</h2>
<p>Graphcore provides examples of a variety of models on Github <a href="https://github.com/graphcore/examples">https://github.com/graphcore/examples</a>. When following the instructions, note that since we are using a container within a Kubernetes pod, there is no need to enable the Poplar/PopART SDK, set up a virtual python environment, or install the PopTorch wheel.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["tabs"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>